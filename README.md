# SECURE_LAB_4
## Анализ в SonarCloud
![image](https://user-images.githubusercontent.com/87932748/200593896-511a71ff-1d04-4b25-97f5-6a52779b0f1b.png)
##  Анализ ошибок в коде
Значение GET параметра `id` никаким образом не проверяется перед добавление его в SQL запрос:
```php
  $id = $_GET[ 'id' ];
```
Оно записывается в переменную `$id`, далее с помощью этой переменной формируется запрос и успешно выполняется на стороне сервера:
```php
$getid  = "SELECT first_name, last_name FROM users WHERE user_id = '$id';";
$result = mysqli_query($GLOBALS["___mysqli_ston"],  $getid );
```
Данный код уязвим к SQL-инъекциям

## Исправление ошибок в коде

1. Добавлено использование технология PDO (PHP Data Objects — расширение для PHP, предоставляющее разработчику универсальный интерфейс для доступа к различным базам данных)
2. Добавлено использование функции `is_numeric()` для проверки вводимого значения `id`
3. Добавлен код для защиты от CSRF атак. Теперь пользватель отправляет запрос с токеном, который не позволит выполнить поддельные запросы

Исправленный вариант: `fixed.php`

![image](https://user-images.githubusercontent.com/87932748/200596607-56f366d7-68c9-4fbc-9ddc-1806d28f65b8.png)
